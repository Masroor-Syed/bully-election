var app=function(){"use strict";function t(){}function e(t,e){for(const s in e)t[s]=e[s];return t}function s(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(s)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){t.appendChild(e)}function c(t,e,s){t.insertBefore(e,s||null)}function a(t){t.parentNode.removeChild(t)}function u(t,e){for(let s=0;s<t.length;s+=1)t[s]&&t[s].d(e)}function f(t){return document.createElement(t)}function h(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function d(t){return document.createTextNode(t)}function g(){return d(" ")}function p(){return d("")}function m(t,e,s,n){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s,n)}function v(t,e,s){null==s?t.removeAttribute(e):t.getAttribute(e)!==s&&t.setAttribute(e,s)}function $(t){return""===t?void 0:+t}function x(t,e){e=""+e,t.data!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}let y;function _(t){y=t}function z(t){(function(){if(!y)throw new Error("Function called outside component initialization");return y})().$$.on_mount.push(t)}const M=[],b=[],P=[],L=[],k=Promise.resolve();let I=!1;function E(t){P.push(t)}let B=!1;const H=new Set;function q(){if(!B){B=!0;do{for(let t=0;t<M.length;t+=1){const e=M[t];_(e),S(e.$$)}for(M.length=0;b.length;)b.pop()();for(let t=0;t<P.length;t+=1){const e=P[t];H.has(e)||(H.add(e),e())}P.length=0}while(M.length);for(;L.length;)L.pop()();I=!1,B=!1,H.clear()}}function S(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(E)}}const V=new Set;let C;function A(){C={r:0,c:[],p:C}}function N(){C.r||o(C.c),C=C.p}function O(t,e){t&&t.i&&(V.delete(t),t.i(e))}function W(t,e,s,n){if(t&&t.o){if(V.has(t))return;V.add(t),C.c.push(()=>{V.delete(t),n&&(s&&t.d(1),n())}),t.o(e)}}function T(t){t&&t.c()}function j(t,e,n){const{fragment:i,on_mount:l,on_destroy:c,after_update:a}=t.$$;i&&i.m(e,n),E(()=>{const e=l.map(s).filter(r);c?c.push(...e):o(e),t.$$.on_mount=[]}),a.forEach(E)}function F(t,e){const s=t.$$;null!==s.fragment&&(o(s.on_destroy),s.fragment&&s.fragment.d(e),s.on_destroy=s.fragment=null,s.ctx=[])}function R(t,e){-1===t.$$.dirty[0]&&(M.push(t),I||(I=!0,k.then(q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(e,s,r,i,l,c,u=[-1]){const f=y;_(e);const h=s.props||{},d=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:n(),dirty:u};let g=!1;if(d.ctx=r?r(e,h,(t,s,...n)=>{const o=n.length?n[0]:s;return d.ctx&&l(d.ctx[t],d.ctx[t]=o)&&(d.bound[t]&&d.bound[t](o),g&&R(e,t)),s}):[],d.update(),g=!0,o(d.before_update),d.fragment=!!i&&i(d.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);d.fragment&&d.fragment.l(t),t.forEach(a)}else d.fragment&&d.fragment.c();s.intro&&O(e.$$.fragment),j(e,s.target,s.anchor),q()}_(f)}class X{$destroy(){F(this,1),this.$destroy=t}$on(t,e){const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}$set(){}}function Y(e){let s,n,o,r,i;return{c(){s=h("g"),n=h("g"),o=h("circle"),r=h("text"),i=d(e[1]),v(o,"stroke","black"),v(o,"stroke-width","0px"),v(o,"fill",G),v(o,"cx",e[2]),v(o,"cy",e[3]),v(o,"r",Z),v(r,"font-weight","bold"),v(r,"x",e[2]),v(r,"y",e[3]),v(r,"dominant-baseline","central"),v(r,"text-anchor","middle"),v(r,"stroke-width","1px"),v(n,"id",e[0])},m(t,e){c(t,s,e),l(s,n),l(n,o),l(n,r),l(r,i)},p(t,[e]){4&e&&v(o,"cx",t[2]),8&e&&v(o,"cy",t[3]),2&e&&x(i,t[1]),4&e&&v(r,"x",t[2]),8&e&&v(r,"y",t[3]),1&e&&v(n,"id",t[0])},i:t,o:t,d(t){t&&a(s)}}}const Z=50,G="#D0F0C0";function J(t,e,s){let{id:n}=e,{name:o}=e,{text:r}=e,{xloc:i}=e,{yloc:l}=e;return t.$set=t=>{"id"in t&&s(0,n=t.id),"name"in t&&s(1,o=t.name),"text"in t&&s(4,r=t.text),"xloc"in t&&s(2,i=t.xloc),"yloc"in t&&s(3,l=t.yloc)},[n,o,i,l,r]}class K extends X{constructor(t){super(),D(this,t,J,Y,i,{id:0,name:1,text:4,xloc:2,yloc:3})}}function Q(e){let s,n,o,r,i,u,f,g;return{c(){s=h("g"),n=h("path"),i=h("text"),u=h("textPath"),f=d(e[0]),v(n,"id",o="arrow-"+e[2]),v(n,"d",r=`M ${e[1].start.x} ${e[1].start.y} L ${e[1].end.x} ${e[1].end.y}`),v(n,"stroke","black"),v(n,"fill","transparent"),v(n,"stroke-width","2"),v(n,"marker-end","url(#head)"),v(u,"startOffset","50%"),v(u,"href",g="#arrow-"+e[2]),v(i,"font-size","1.5rem"),v(i,"text-anchor","middle"),v(i,"dominant-baseline","hanging")},m(t,e){c(t,s,e),l(s,n),l(s,i),l(i,u),l(u,f)},p(t,[e]){2&e&&r!==(r=`M ${t[1].start.x} ${t[1].start.y} L ${t[1].end.x} ${t[1].end.y}`)&&v(n,"d",r),1&e&&x(f,t[0])},i:t,o:t,d(t){t&&a(s)}}}function U(t,e,s){const n=e.x-t.x,o=t.y-e.y,r=Math.atan2(o,n),i=s*Math.cos(r),l=s*-Math.sin(r);return{x:t.x+i,y:t.y+l}}function tt(t,e,s){let n,{from:o}=e,{to:r}=e,{pcount:i}=e,{text:l}=e,c=`${r}-${o}`;function a(t,e){return{x:450+e*Math.sin(2*Math.PI/i*t),y:300+e*-Math.cos(2*Math.PI/i*t)}}return t.$set=t=>{"from"in t&&s(3,o=t.from),"to"in t&&s(4,r=t.to),"pcount"in t&&s(5,i=t.pcount),"text"in t&&s(0,l=t.text)},t.$$.update=()=>{56&t.$$.dirty&&s(1,n=function(t,e,s){let n=a(parseInt(t),250),o=a(parseInt(e),250);return{start:U(n,o,50),end:U(o,n,55)}}(o,r))},[l,n,c,o,r,i]}class et extends X{constructor(t){super(),D(this,t,tt,Q,i,{from:3,to:4,pcount:5,text:0})}}class st{constructor(t,e){this.id=t,this.name=e,this.messages=[],this.msg_queue="",this.leader=t,this.recieved_leader=0,this.text="",this.running=!1,this.otherProcesses=[],this.active=!1,this.arrows=[]}setOtherProcesses(t){for(let e=0;e<t.length;e++)t[e].id!=this.id&&this.otherProcesses.push(t[e])}setRunnig(t){this.running=t}getState(){let t=this.messages.join(" ");return{id:this.id,name:this.name,text:t,active:this.active,arrows:this.arrows}}}class nt{constructor(t,e){this.processes=[...Array(t).keys()].map(t=>new st(1+t,"Process ".concat((1+t).toString()))),this.election_starter=this.processes[e-1],this.election_starter.setRunnig(!0),this.sim_running=!0;for(let t=0;t<this.processes.length;t++)this.processes[t].setOtherProcesses(this.processes)}getBully(t){let e=t.id;for(let s=0;s<t.otherProcesses.length;s++)t.otherProcesses[s].id>e&&(e=t.otherProcesses[s].id);return e}leader_msg(t,e){let s=`Leader( ${t.id} )`;e.msg_queue=s,t.active=!0;let n={to:e.id-1,from:t.id-1,msg:s};t.arrows.push(n)}election_msg(t,e){let s=`Election( ${t.id} )`;e.msg_queue=s,t.active=!0;let n={to:e.id-1,from:t.id-1,msg:s};t.arrows.push(n)}bully_msg(t,e){let s=`Bully( ${t.id} )`;t.msg_queue=s,e.msg_queue="I",e.active=!0;let n={to:t.id-1,from:e.id-1,msg:s};e.arrows.push(n)}init_election(t){if(t.running=!0,this.getBully(t)===t.id){let e=`Leader( ${t.id} )`;t.messages=[...t.messages,e];for(let e=0;e<t.otherProcesses.length;e++)t.otherProcesses[e].id!=t.id&&this.leader_msg(t,t.otherProcesses[e])}else{let e=`Election( ${t.id} )`;t.messages=[...t.messages,e];for(let e=0;e<t.otherProcesses.length;e++)t.otherProcesses[e].id>t.id&&this.election_msg(t,t.otherProcesses[e])}}particpateInElection(t){let e=t.msg_queue;if(t.msg_queue="",e.startsWith("L"))t.messages=[...t.messages,e],this.sim_running=!1,t.leader=parseInt(e.split(" ")[1]);else if(e.startsWith("E")){t.messages=[...t.messages,e];let s=parseInt(e.split(" ")[1]);if(s<t.id){let e=this.processes[s-1],n=`Bully( ${e.id} )`;t.messages=[...t.messages,n],this.bully_msg(e,t)}}else e.startsWith("B")?t.running=!1:e.startsWith("I")&&this.init_election(t)}election(){if(this.election_starter)this.init_election(this.processes[this.election_starter.id-1]),this.election_starter=null;else for(let t=0;t<this.processes.length;t++)this.processes[t].msg_queue&&this.particpateInElection(this.processes[t])}unactivateArrows(){for(let t=0;t<this.processes.length;t++)this.processes[t].active=!1,this.processes[t].arrows=[]}step(){this.sim_running&&(this.unactivateArrows(),this.election(),console.log(this.processes))}}function ot(t,e,s){const n=t.slice();return n[16]=e[s],n[18]=s,n}function rt(t,e,s){const n=t.slice();return n[20]=e[s],n[18]=s,n}function it(t,e,s){const n=t.slice();return n[16]=e[s],n[18]=s,n}function lt(t){let e,s,n=t[16].arrows,o=[];for(let e=0;e<n.length;e+=1)o[e]=ct(rt(t,n,e));const r=t=>W(o[t],1,1,()=>{o[t]=null});return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=p()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);c(t,e,n),s=!0},p(t,s){if(5&s){let i;for(n=t[16].arrows,i=0;i<n.length;i+=1){const r=rt(t,n,i);o[i]?(o[i].p(r,s),O(o[i],1)):(o[i]=ct(r),o[i].c(),O(o[i],1),o[i].m(e.parentNode,e))}for(A(),i=n.length;i<o.length;i+=1)r(i);N()}},i(t){if(!s){for(let t=0;t<n.length;t+=1)O(o[t]);s=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)W(o[t]);s=!1},d(t){u(o,t),t&&a(e)}}}function ct(t){let e,s;return e=new et({props:{from:t[20].from,to:t[20].to,pcount:t[0],text:t[20].msg}}),{c(){T(e.$$.fragment)},m(t,n){j(e,t,n),s=!0},p(t,s){const n={};4&s&&(n.from=t[20].from),4&s&&(n.to=t[20].to),1&s&&(n.pcount=t[0]),4&s&&(n.text=t[20].msg),e.$set(n)},i(t){s||(O(e.$$.fragment,t),s=!0)},o(t){W(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function at(t){let s,n,o;const r=[t[16],{xloc:450+250*Math.sin(2*Math.PI/t[0]*t[18])},{yloc:300+250*-Math.cos(2*Math.PI/t[0]*t[18])}];let i={};for(let t=0;t<r.length;t+=1)i=e(i,r[t]);s=new K({props:i});let l=t[16].active&&lt(t);return{c(){T(s.$$.fragment),l&&l.c(),n=p()},m(t,e){j(s,t,e),l&&l.m(t,e),c(t,n,e),o=!0},p(t,e){const o=5&e?function(t,e){const s={},n={},o={$$scope:1};let r=t.length;for(;r--;){const i=t[r],l=e[r];if(l){for(const t in i)t in l||(n[t]=1);for(const t in l)o[t]||(s[t]=l[t],o[t]=1);t[r]=l}else for(const t in i)o[t]=1}for(const t in n)t in s||(s[t]=void 0);return s}(r,[4&e&&(i=t[16],"object"==typeof i&&null!==i?i:{}),1&e&&{xloc:450+250*Math.sin(2*Math.PI/t[0]*t[18])},1&e&&{yloc:300+250*-Math.cos(2*Math.PI/t[0]*t[18])}]):{};var i;s.$set(o),t[16].active?l?(l.p(t,e),4&e&&O(l,1)):(l=lt(t),l.c(),O(l,1),l.m(n.parentNode,n)):l&&(A(),W(l,1,1,()=>{l=null}),N())},i(t){o||(O(s.$$.fragment,t),O(l),o=!0)},o(t){W(s.$$.fragment,t),W(l),o=!1},d(t){F(s,t),l&&l.d(t),t&&a(n)}}}function ut(t){let e,s,n,o,r=t[16].name+"",i=t[16].text+"";return{c(){e=f("p"),s=d(r),n=d(": "),o=d(i)},m(t,r){c(t,e,r),l(e,s),l(e,n),l(e,o)},p(t,e){4&e&&r!==(r=t[16].name+"")&&x(s,r),4&e&&i!==(i=t[16].text+"")&&x(o,i)},d(t){t&&a(e)}}}function ft(t){let e,s,n,r,i,p,y,_,z,M,b,P,L,k,I,B,H,q,S,V,C,T,j,F,R,D,X,Y,Z,G,J,K,Q,U,tt,et,st,nt,rt,lt,ct,ft,dt,gt,pt,mt,vt;E(t[9]);let $t=t[2],xt=[];for(let e=0;e<$t.length;e+=1)xt[e]=at(it(t,$t,e));const wt=t=>W(xt[t],1,1,()=>{xt[t]=null});let yt=t[2],_t=[];for(let e=0;e<yt.length;e+=1)_t[e]=ut(ot(t,yt,e));return{c(){e=f("main"),s=f("div"),s.innerHTML='<h1 class="svelte-ssvfzu">Bully Election Simulation</h1>',n=g(),r=f("div"),i=f("div"),p=h("svg"),y=h("defs"),_=h("marker"),z=h("path");for(let t=0;t<xt.length;t+=1)xt[t].c();M=g(),b=f("div"),P=f("h2"),P.textContent="Options",L=g(),k=f("div"),I=f("b"),I.textContent="# Processes:",B=g(),H=f("div"),q=f("input"),S=g(),V=f("span"),C=d(t[0]),T=g(),j=f("div"),F=f("b"),F.textContent="Process starting election",R=g(),D=f("div"),X=f("div"),Y=f("input"),G=g(),J=f("div"),K=f("button"),K.innerHTML='<svg viewBox="0 0 50 50" class="svelte-ssvfzu"><g xmlns="http://www.w3.org/2000/svg" id="Layer_1_1_"><path d="M23,49V1H11v48H23z M13,3h8v44h-8V3z"></path><path d="M39,49V1H27v48H39z M29,3h8v44h-8V3z"></path></g></svg>',Q=g(),U=f("button"),U.innerHTML='<svg viewBox="0 0 50 50" class="svelte-ssvfzu"><path xmlns="http://www.w3.org/2000/svg" d="M7,1.217v47.566L45.918,25L7,1.217z\n              M9,4.783L42.082,25L9,45.217V4.783z"></path></svg>',tt=g(),et=f("button"),et.innerHTML='<svg viewBox="0 0 50 50" class="svelte-ssvfzu"><path xmlns="http://www.w3.org/2000/svg" d="M24,49.414L48.414,25L24,0.586v23l-23-23v48.828l23-23V49.414z\n              M3,44.586V5.414L22.586,25L3,44.586z M26,5.414L45.586,25\n              L26,44.586V5.414z"></path></svg>',st=g(),nt=f("div"),rt=f("button"),rt.textContent="Step",lt=g(),ct=f("div"),ft=f("h2"),ft.textContent="Process Messages",dt=g(),gt=f("div");for(let t=0;t<_t.length;t+=1)_t[t].c();v(z,"d","M0,0 V4 L2,2 Z"),v(z,"fill","black"),v(_,"id","head"),v(_,"orient","auto"),v(_,"markerWidth","2"),v(_,"markerHeight","4"),v(_,"refX","0.1"),v(_,"refY","2"),v(p,"viewBox","50 -50 800 800"),v(p,"width",ht),v(p,"height",ht),v(i,"id","sim"),v(i,"class","svelte-ssvfzu"),v(q,"type","range"),v(q,"min","2"),v(q,"max","7"),v(q,"class","svelte-ssvfzu"),v(V,"class","svelte-ssvfzu"),v(H,"class","svelte-ssvfzu"),v(k,"id","procs"),v(k,"class","option svelte-ssvfzu"),v(Y,"type","number"),v(Y,"min",Z=2),v(Y,"max",t[0]),v(Y,"class","svelte-ssvfzu"),v(X,"class","range svelte-ssvfzu"),v(D,"id","code"),v(D,"class","svelte-ssvfzu"),v(j,"id","times"),v(j,"class","option svelte-ssvfzu"),v(K,"id","manual"),v(K,"class","svelte-ssvfzu"),v(U,"id","default"),v(U,"class","svelte-ssvfzu"),v(et,"id","fast"),v(et,"class","svelte-ssvfzu"),v(J,"id","speed"),v(J,"class","option svelte-ssvfzu"),v(rt,"id","step"),v(rt,"class","svelte-ssvfzu"),v(nt,"id","stepper"),v(nt,"class","option svelte-ssvfzu"),v(b,"id","options"),v(b,"class","svelte-ssvfzu"),v(r,"id","container"),v(r,"class","svelte-ssvfzu"),v(gt,"id","msgs"),v(gt,"class","option svelte-ssvfzu"),v(ct,"class","svelte-ssvfzu"),v(e,"class","svelte-ssvfzu")},m(o,a){c(o,e,a),l(e,s),l(e,n),l(e,r),l(r,i),l(i,p),l(p,y),l(y,_),l(_,z);for(let t=0;t<xt.length;t+=1)xt[t].m(p,null);l(r,M),l(r,b),l(b,P),l(b,L),l(b,k),l(k,I),l(k,B),l(k,H),l(H,q),w(q,t[0]),l(H,S),l(H,V),l(V,C),l(b,T),l(b,j),l(j,F),l(j,R),l(j,D),l(D,X),l(X,Y),w(Y,t[1]),l(b,G),l(b,J),l(J,K),l(J,Q),l(J,U),l(J,tt),l(J,et),l(b,st),l(b,nt),l(nt,rt),l(e,lt),l(e,ct),l(ct,ft),l(ct,dt),l(ct,gt);for(let t=0;t<_t.length;t+=1)_t[t].m(gt,null);pt=!0,mt||(vt=[m(window,"resize",t[9]),m(q,"change",t[10]),m(q,"input",t[10]),m(Y,"input",t[11]),m(K,"click",t[5]),m(U,"click",t[6]),m(et,"click",t[7]),m(rt,"click",t[8])],mt=!0)},p(t,[e]){if(5&e){let s;for($t=t[2],s=0;s<$t.length;s+=1){const n=it(t,$t,s);xt[s]?(xt[s].p(n,e),O(xt[s],1)):(xt[s]=at(n),xt[s].c(),O(xt[s],1),xt[s].m(p,null))}for(A(),s=$t.length;s<xt.length;s+=1)wt(s);N()}if(1&e&&w(q,t[0]),(!pt||1&e)&&x(C,t[0]),(!pt||1&e)&&v(Y,"max",t[0]),2&e&&$(Y.value)!==t[1]&&w(Y,t[1]),4&e){let s;for(yt=t[2],s=0;s<yt.length;s+=1){const n=ot(t,yt,s);_t[s]?_t[s].p(n,e):(_t[s]=ut(n),_t[s].c(),_t[s].m(gt,null))}for(;s<_t.length;s+=1)_t[s].d(1);_t.length=yt.length}},i(t){if(!pt){for(let t=0;t<$t.length;t+=1)O(xt[t]);pt=!0}},o(t){xt=xt.filter(Boolean);for(let t=0;t<xt.length;t+=1)W(xt[t]);pt=!1},d(t){t&&a(e),u(xt,t),u(_t,t),mt=!1,o(vt)}}}let ht=650;function dt(t,e,s){let n,o,r=4,i=1;function l(){c.step(),s(2,n=c.processes.map(t=>t.getState()))}z(()=>()=>{clearInterval(o)});let c,a=786,u=576;return t.$$.update=()=>{3&t.$$.dirty&&s(13,c=new nt(r,i)),8192&t.$$.dirty&&s(2,n=[...c&&!c.processes?[]:c.processes.map(t=>t.getState())]),t.$$.dirty},[r,i,n,a,u,function(){clearInterval(o)},function(){clearInterval(o),o=setInterval(()=>{l()},1e3)},function(){clearInterval(o),o=setInterval(()=>{l()},300)},l,function(){s(3,a=window.innerWidth),s(4,u=window.innerHeight)},function(){r=$(this.value),s(0,r)},function(){i=$(this.value),s(1,i)}]}return new class extends X{constructor(t){super(),D(this,t,dt,ft,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
